<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Vue </title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!--<link rel="stylesheet" type="text/css" href="style.css"/>-->
</head>

<script ></script>
<body >
<div id="app">
<!--   背景图片-->
<div>
    <div>
        <!--<img src="./photo/4.jpg" alt="背景图片" class="bg_img" >-->
    </div>
</div>
<!--       登录界面-->
<div id="white_panel">
    <div class="title_1">
        <h1>欢迎注册</h1>
        <p>已有账号？
            <a href="#">点此登录</a>
        </p>
    </div>
<!--       填写注册信息-->
    <div class="title_2">
        <label class="label_box">账&emsp;&emsp;号</label>
        <input class="input_box" type="text" name="userName" placeholder="学号只能由数字组成" v-model="user.username">
    </div>
    <div class="title_2">
        <label class="label_box">密&emsp;&emsp;码</label>
        <input class="input_box" type="password" name="password" placeholder="请设置登录密码" v-model="user.password">
    </div>
    <div class="title_2">
        <label class="label_box">电话号码</label>
        <input class="input_box" type="text" name="phoneNumber" placeholder="请输入11位的电话号码" v-model="user.phoneNumber">
    </div>
    <div class="title_2">
        <label class="label_box">验&ensp;证&ensp;码</label>
        <input class="input_box" type="text" placeholder="请输入验证码" v-model="code">
        <p style="margin-top:25px">
        <a href="javascript:;" @click="getImg">换一张&emsp;&emsp;</a>
        <img id="num" :src="url">
        </p>
    </div>
<!--    提交注册信息-->
    <div class="title_2">
        <button class="bn_st bn_st2" type="submit" @click="register">注册</button>
    </div>
</div>
</div>
<!--你的目录-->

</body>
</html>

<script src="/js/vue.js"></script>
<script src="/js/axios.min.js"></script>
<script>
    var app = new Vue({
        el:"#app",
        data:{
            url:"",
            user:{},
            code:"",
        },
        methods:{
            //更换验证码
            getImg(){
                this.getSrc();
            },
            //获取验证码的url
            getSrc() {
                var _this = this;
                axios.get("http://localhost:8989/user/image?time=" + Math.random()).then(res => {
                    _this.url = res.data;
                });
            },
            //用来注册用户信息
            register() {
                console.log("hello");
                axios.post("http://localhost:8989/user/register?code=" + this.code, this.user).then(res => {
                    console.log(res.data);
                    if (res.data.state) {
                        alert(res.data.msg + ",点击确定跳转至登录页面!");
                        location.href = "";
                    } else {
                        alert(res.data.msg);
                    }
                });
            }
        },
        created() {
            //获取验证码
            this.getSrc();
        }
    })
</script>
